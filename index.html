<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube AI Viral Video - Gemini Edition</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
            line-height: 1.6;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #4285f4, #34a853, #fbbc05, #ea4335);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .gemini-badge {
            display: inline-block;
            background: linear-gradient(45deg, #4285f4, #8e44ad);
            color: #fff;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
            font-size: 0.9em;
        }
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        @media (max-width: 968px) { .main-grid { grid-template-columns: 1fr; } }
        .panel {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .panel h2 {
            margin-bottom: 20px;
            color: #4285f4;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .form-group { margin-bottom: 20px; }
        label {
            display: block;
            margin-bottom: 8px;
            color: #ddd;
            font-weight: 500;
        }
        input[type="text"], input[type="password"], textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            background: rgba(0,0,0,0.3);
            color: #fff;
            font-size: 14px;
            transition: all 0.3s;
        }
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #4285f4;
            background: rgba(0,0,0,0.5);
        }
        textarea { min-height: 100px; resize: vertical; }
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        button:disabled { opacity: 0.6; cursor: not-allowed; }
        .btn-primary { background: linear-gradient(45deg, #4285f4, #8e44ad); color: white; }
        .btn-success { background: linear-gradient(45deg, #00b894, #00cec9); color: white; }
        .btn-danger { background: linear-gradient(45deg, #eb3349, #f45c43); color: white; }
        .btn-warning { background: linear-gradient(45deg, #f093fb, #f5576c); color: white; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); }
        .status {
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .status.success { background: rgba(0, 184, 148, 0.2); border: 1px solid #00b894; display: block; }
        .status.error { background: rgba(255, 71, 87, 0.2); border: 1px solid #ff4757; display: block; }
        .status.info { background: rgba(66, 133, 244, 0.2); border: 1px solid #4285f4; display: block; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255,255,255,0.05);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.3s;
        }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-number { font-size: 2.5em; font-weight: bold; color: #4285f4; margin-bottom: 5px; }
        .stat-label { color: #aaa; font-size: 0.9em; }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }
        .tab {
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: #aaa;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .tab.active { background: rgba(66, 133, 244, 0.2); color: #4285f4; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .api-config {
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .api-config h4 { color: #4285f4; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .help-link { color: #4285f4; text-decoration: none; font-size: 0.85em; }
        .help-link:hover { text-decoration: underline; }
        .test-btn { padding: 8px 15px; font-size: 12px; margin-top: 10px; }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
            display: none;
        }
        .progress-bar.active { display: block; }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4285f4, #8e44ad);
            width: 0%;
            transition: width 0.3s;
        }
        .media-library {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            margin-top: 15px;
        }
        .media-item {
            aspect-ratio: 16/9;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            transition: transform 0.3s;
            border: 3px solid transparent;
        }
        .media-item:hover { transform: scale(1.05); }
        .media-item.selected { border-color: #00b894; }
        .media-item img { width: 100%; height: 100%; object-fit: cover; }
        .media-item .credit {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            font-size: 11px;
            text-align: center;
        }
        .video-list { max-height: 400px; overflow-y: auto; }
        .video-item {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #4285f4;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        .video-item.uploaded { border-left-color: #00b894; }
        .video-info h4 { color: #fff; margin-bottom: 5px; }
        .video-info p { color: #aaa; font-size: 0.85em; }
        .video-actions { display: flex; gap: 10px; }
        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }
        .preview-content {
            background: #1a1a2e;
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            padding: 30px;
            position: relative;
            border: 1px solid rgba(255,255,255,0.1);
            max-height: 90vh;
            overflow-y: auto;
        }
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: #fff;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .video-preview-container {
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            aspect-ratio: 9/16;
            max-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 20px;
        }
        .script-box {
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(66, 133, 244, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            color: #ddd;
            width: 100%;
        }
        .ai-analysis {
            background: rgba(66, 133, 244, 0.1);
            border: 1px solid rgba(66, 133, 244, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        .ai-analysis h3 { color: #4285f4; margin-bottom: 10px; }
        .viral-score {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }
        .viral-score.high { background: rgba(0, 184, 148, 0.2); color: #00b894; }
        .viral-score.medium { background: rgba(254, 202, 87, 0.2); color: #feca57; }
        .viral-score.low { background: rgba(255, 71, 87, 0.2); color: #ff4757; }
        .log-container {
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            line-height: 1.6;
        }
        .log-entry { margin-bottom: 8px; padding: 5px; border-radius: 5px; }
        .log-entry.info { color: #4285f4; }
        .log-entry.success { color: #00b894; }
        .log-entry.error { color: #ff4757; }
        .log-entry.warning { color: #feca57; }
        .hidden { display: none !important; }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .api-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            margin: 5px;
        }
        .api-status.ok { background: rgba(0, 184, 148, 0.2); color: #00b894; border: 1px solid #00b894; }
        .api-status.missing { background: rgba(255, 71, 87, 0.2); color: #ff4757; border: 1px solid #ff4757; }
        .setup-warning {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }
        .setup-warning h3 { color: #ffc107; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé¨ YouTube AI Viral Video Sistemi</h1>
            <p>Google Gemini Edition - Yapay Zeka Destekli</p>
            <div class="gemini-badge">ü§ñ Powered by Gemini 1.5 Flash</div>
        </header>

        <div class="setup-warning" id="apiCheck">
            <h3>üîë API Baƒülantƒ± Durumu</h3>
            <div style="margin: 15px 0;">
                <span class="api-status missing" id="geminiStatus">‚ùå Gemini API</span>
                <span class="api-status missing" id="youtubeStatus">‚ùå YouTube API</span>
            </div>
            <p style="color: #aaa; font-size: 0.9em;">API'leri yapƒ±landƒ±rmak i√ßin Ayarlar sekmesine gidin</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalVideos">0</div>
                <div class="stat-label">Toplam Video</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="uploadedVideos">0</div>
                <div class="stat-label">Y√ºklenen</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="viralVideos">0</div>
                <div class="stat-label">Viral Skor 8+</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="savedCredits">0</div>
                <div class="stat-label">Tasarruf (TL)</div>
            </div>
        </div>

        <div class="main-grid">
            <div class="panel">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('settings')">‚öôÔ∏è API Ayarlarƒ±</button>
                    <button class="tab" onclick="switchTab('analyze')">üìä Analiz</button>
                    <button class="tab" onclick="switchTab('create')">üé• Olu≈ütur</button>
                </div>

                <div id="settings-tab" class="tab-content active">
                    <div class="api-config">
                        <h4>ü§ñ Google Gemini API 
                            <a href="https://aistudio.google.com/app/apikey" target="_blank" class="help-link">[API Key Al]</a>
                        </h4>
                        <div class="form-group">
                            <label>API Key (AIza... ile ba≈ülar)</label>
                            <input type="password" id="geminiApiKey" placeholder="AIzaSy...">
                        </div>
                        <button class="btn-primary test-btn" onclick="testGemini()">üß™ Test Et</button>
                        <div id="geminiTestResult" class="status" style="margin-top: 10px;"></div>
                    </div>

                    <div class="api-config">
                        <h4>üì∫ YouTube Data API 
                            <a href="https://console.cloud.google.com/apis/credentials" target="_blank" class="help-link">[Nasƒ±l Alƒ±nƒ±r?]</a>
                        </h4>
                        <div class="form-group">
                            <label>YouTube API Key (Opsiyonel - sadece analiz i√ßin)</label>
                            <input type="password" id="youtubeApiKey" placeholder="AIzaSy...">
                        </div>
                        <div class="form-group">
                            <label>OAuth Client ID (YouTube Upload i√ßin gerekli)</label>
                            <input type="text" id="youtubeClientId" placeholder="...apps.googleusercontent.com">
                        </div>
                        <button class="btn-primary test-btn" onclick="testYouTube()">üß™ Test Et</button>
                        <button class="btn-secondary test-btn" onclick="authenticateYouTube()">üîê YouTube'a Baƒülan</button>
                        <div id="youtubeTestResult" class="status" style="margin-top: 10px;"></div>
                    </div>

                    <button class="btn-success" onclick="saveAllSettings()" style="width: 100%; margin-top: 20px;">
                        üíæ T√ºm Ayarlarƒ± Kaydet
                    </button>
                </div>

                <div id="analyze-tab" class="tab-content">
                    <div class="form-group">
                        <label>Analiz Edilecek Konu veya Kanal</label>
                        <input type="text" id="analyzeQuery" placeholder="√ñrn: teknoloji, yemek tarifleri, @kanaladi">
                    </div>
                    <button class="btn-primary" onclick="analyzeTopic()" id="analyzeBtn" disabled>
                        üîç Trend Analizi Yap
                    </button>
                    <div class="progress-bar" id="analyzeProgress">
                        <div class="progress-fill" id="analyzeProgressFill"></div>
                    </div>
                    <div id="analyzeStatus" class="status"></div>
                    
                    <div id="aiAnalysisResult" class="ai-analysis hidden">
                        <h3>ü§ñ AI Viral Analiz Raporu</h3>
                        <div id="analysisContent"></div>
                    </div>
                </div>

                <div id="create-tab" class="tab-content">
                    <div class="form-group">
                        <label>Video Konusu / Prompt</label>
                        <textarea id="videoPrompt" placeholder="Ne hakkƒ±nda video istediƒüinizi detaylƒ± yazƒ±n... √ñrn: '2024'te √ßƒ±kacak en iyi 5 teknoloji √ºr√ºn√º'"></textarea>
                    </div>

                    <div class="form-group">
                        <label>G√∂rsel Kaynaƒüƒ±</label>
                        <select id="mediaSource">
                            <option value="pexels">Pexels (Fotoƒüraf)</option>
                            <option value="pixabay">Pixabay (Fotoƒüraf)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>G√∂rsel Arama Anahtar Kelimesi</label>
                        <input type="text" id="mediaSearch" placeholder="√ñrn: technology, nature, food">
                        <button class="btn-secondary" onclick="searchMedia()" style="margin-top: 10px; width: 100%;">
                            üîç G√∂rsel Ara
                        </button>
                    </div>

                    <div id="mediaResults" class="media-library hidden"></div>

                    <div class="form-group" style="margin-top: 20px;">
                        <label>Video Formatƒ±</label>
                        <select id="videoFormat">
                            <option value="shorts">YouTube Shorts (Dikey 9:16)</option>
                            <option value="standard">Standart Video (Yatay 16:9)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Video S√ºresi</label>
                        <select id="videoDuration">
                            <option value="30">30 saniye</option>
                            <option value="60" selected>60 saniye</option>
                            <option value="180">3 dakika</option>
                        </select>
                    </div>

                    <button class="btn-success" onclick="createVideo()" id="createBtn" disabled style="width: 100%;">
                        ‚ú® Video Olu≈ütur
                    </button>

                    <div class="progress-bar" id="createProgress">
                        <div class="progress-fill" id="createProgressFill"></div>
                    </div>
                    <div id="createStatus" class="status"></div>
                </div>
            </div>

            <div class="panel">
                <h2>üìÅ Videolarƒ±m</h2>
                <div class="video-list" id="videoList">
                    <p style="text-align: center; color: #666; padding: 40px;">
                        Hen√ºz video olu≈üturulmadƒ±.
                    </p>
                </div>
            </div>
        </div>

        <div class="panel" style="margin-top: 30px;">
            <h2>üìã Sistem Loglarƒ±</h2>
            <div class="log-container" id="logContainer">
                <div class="log-entry info">Gemini Edition ba≈ülatƒ±ldƒ±...</div>
            </div>
            <button class="btn-warning" onclick="clearLogs()" style="margin-top: 10px;">
                üóëÔ∏è Temizle
            </button>
        </div>
    </div>

    <div class="preview-modal" id="previewModal">
        <div class="preview-content">
            <button class="close-modal" onclick="closePreview()">√ó</button>
            <h2>üé¨ Video √ñnizleme</h2>
            
            <div class="video-preview-container">
                <div style="text-align: center; color: #666;">
                    <div style="font-size: 4em; margin-bottom: 20px;">üé•</div>
                    <p>Video olu≈üturma √∂zelliƒüi yakƒ±nda geliyor!</p>
                    <p style="font-size: 0.9em; margin-top: 10px;">≈ûu an i√ßin i√ßerik metnini kullanabilirsiniz.</p>
                </div>
            </div>

            <div class="ai-analysis">
                <h3>üìù Video Senaryosu</h3>
                <div id="previewScript" class="script-box"></div>
            </div>

            <div class="ai-analysis">
                <h3>üìä Video Detaylarƒ±</h3>
                <div id="previewDetails"></div>
            </div>

            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                <button class="btn-danger" onclick="rejectVideo()">‚ùå Sil</button>
                <button class="btn-success" onclick="downloadContent()">üíæ ƒ∞√ßeriƒüi ƒ∞ndir</button>
                <button class="btn-primary" onclick="uploadToYouTube()">üì§ YouTube'a Y√ºkle</button>
            </div>

            <div class="progress-bar" id="uploadProgress" style="margin-top: 20px;">
                <div class="progress-fill" id="uploadProgressFill"></div>
            </div>
            <div id="uploadStatus" class="status"></div>
        </div>
    </div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        let settings = JSON.parse(localStorage.getItem('ytSettingsGemini') || '{}');
        let videos = JSON.parse(localStorage.getItem('ytVideosGemini') || '[]');
        let currentVideo = null;
        let selectedMedia = [];
        let channelAnalysis = null;

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            loadSettings();
            updateStats();
            updateVideoList();
            checkApiStatus();
            addLog('üöÄ Gemini Edition hazƒ±r', 'success');
            
            // Check for OAuth callback
            handleOAuthCallback();
        });

        // ==================== UI FUNCTIONS ====================
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }

        function updateStatus(id, ok) {
            const el = document.getElementById(id);
            el.className = 'api-status ' + (ok ? 'ok' : 'missing');
            el.innerHTML = (ok ? '‚úÖ' : '‚ùå') + ' ' + el.textContent.slice(2);
        }

        function checkApiStatus() {
            if (settings.geminiKey) updateStatus('geminiStatus', true);
            if (settings.youtubeApiKey) updateStatus('youtubeStatus', true);
            document.getElementById('analyzeBtn').disabled = !settings.geminiKey;
            document.getElementById('createBtn').disabled = !settings.geminiKey;
        }

        function loadSettings() {
            if (settings.geminiKey) document.getElementById('geminiApiKey').value = settings.geminiKey;
            if (settings.youtubeApiKey) document.getElementById('youtubeApiKey').value = settings.youtubeApiKey;
            if (settings.youtubeClientId) document.getElementById('youtubeClientId').value = settings.youtubeClientId;
        }

        function saveAllSettings() {
            settings.geminiKey = document.getElementById('geminiApiKey').value.trim();
            settings.youtubeApiKey = document.getElementById('youtubeApiKey').value.trim();
            settings.youtubeClientId = document.getElementById('youtubeClientId').value.trim();
            localStorage.setItem('ytSettingsGemini', JSON.stringify(settings));
            checkApiStatus();
            addLog('Ayarlar kaydedildi', 'success');
            showNotification('‚úÖ Ayarlar kaydedildi!');
        }

        function showNotification(msg) {
            // Custom notification instead of alert
            const div = document.createElement('div');
            div.style.cssText = `
                position: fixed; top: 20px; right: 20px; background: #00b894; 
                color: white; padding: 15px 20px; border-radius: 10px; 
                z-index: 9999; animation: slideIn 0.3s ease;
            `;
            div.textContent = msg;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 3000);
        }

        // ==================== GEMINI API FUNCTIONS ====================
        async function testGemini() {
            const key = document.getElementById('geminiApiKey').value.trim();
            if (!key) {
                showStatus('geminiTestResult', '‚ùå API Key girin', 'error');
                return;
            }
            
            const btn = event.target;
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Test ediliyor...';
            
            try {
                const response = await fetch('/.netlify/functions/gemini-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        apiKey: key, 
                        prompt: 'Merhaba! Sen kimsin ve ne yapabilirsin? Kƒ±sa cevap ver.' 
                    })
                });
                
                const data = await response.json();
                
                if (response.ok && data.candidates && data.candidates[0]) {
                    const text = data.candidates[0].content.parts[0].text;
                    showStatus('geminiTestResult', `‚úÖ Baƒülantƒ± ba≈üarƒ±lƒ±! Yanƒ±t: "${text.substring(0, 100)}..."`, 'success');
                    updateStatus('geminiStatus', true);
                    addLog('Gemini API baƒülantƒ±sƒ± ba≈üarƒ±lƒ±', 'success');
                } else {
                    throw new Error(data.error?.message || 'Ge√ßersiz yanƒ±t formatƒ±');
                }
            } catch (e) {
                showStatus('geminiTestResult', '‚ùå Hata: ' + e.message, 'error');
                addLog('Gemini test hatasƒ±: ' + e.message, 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'üß™ Test Et';
            }
        }

        async function callGemini(prompt, temperature = 0.7) {
            if (!settings.geminiKey) throw new Error('Gemini API Key ayarlanmamƒ±≈ü');
            
            const response = await fetch('/.netlify/functions/gemini-proxy', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    apiKey: settings.geminiKey, 
                    prompt: prompt,
                    temperature: temperature
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'Gemini API hatasƒ±');
            }
            
            const data = await response.json();
            if (!data.candidates || !data.candidates[0]) {
                throw new Error('Gemini bo≈ü yanƒ±t d√∂nd√ºrd√º');
            }
            
            return data.candidates[0].content.parts[0].text;
        }

        // ==================== YOUTUBE API FUNCTIONS ====================
        async function testYouTube() {
            const key = document.getElementById('youtubeApiKey').value.trim();
            if (!key) {
                showStatus('youtubeTestResult', '‚ùå API Key girin', 'error');
                return;
            }
            
            try {
                const response = await fetch('/.netlify/functions/youtube-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: key,
                        endpoint: 'videos',
                        params: { chart: 'mostPopular', maxResults: 1, part: 'snippet' }
                    })
                });
                
                const data = await response.json();
                if (response.ok) {
                    showStatus('youtubeTestResult', '‚úÖ YouTube API baƒülantƒ±sƒ± ba≈üarƒ±lƒ±!', 'success');
                    updateStatus('youtubeStatus', true);
                    addLog('YouTube API baƒülantƒ±sƒ± ba≈üarƒ±lƒ±', 'success');
                } else {
                    throw new Error(data.error || 'YouTube API hatasƒ±');
                }
            } catch (e) {
                showStatus('youtubeTestResult', '‚ùå Hata: ' + e.message, 'error');
                addLog('YouTube test hatasƒ±: ' + e.message, 'error');
            }
        }

        function authenticateYouTube() {
            const clientId = document.getElementById('youtubeClientId').value.trim();
            if (!clientId) {
                alert('√ñnce Client ID girin ve kaydedin');
                return;
            }
            
            // PKCE olmadan implicit flow (geli≈ütirme i√ßin - production'da backend exchange kullanƒ±n)
            const redirectUri = window.location.origin + '/';
            const scope = 'https://www.googleapis.com/auth/youtube.upload https://www.googleapis.com/auth/youtube.readonly';
            const state = Math.random().toString(36).substring(7);
            localStorage.setItem('oauth_state', state);
            
            const url = `https://accounts.google.com/o/oauth2/v2/auth?` +
                `client_id=${encodeURIComponent(clientId)}&` +
                `redirect_uri=${encodeURIComponent(redirectUri)}&` +
                `scope=${encodeURIComponent(scope)}&` +
                `response_type=token&` +
                `state=${state}&` +
                `prompt=consent`;
            
            window.location.href = url;
        }

        function handleOAuthCallback() {
            const hash = window.location.hash;
            if (hash.includes('access_token')) {
                const params = new URLSearchParams(hash.slice(1));
                const token = params.get('access_token');
                const state = params.get('state');
                const error = params.get('error');
                
                if (error) {
                    addLog('YouTube yetkilendirme hatasƒ±: ' + error, 'error');
                    return;
                }
                
                if (state !== localStorage.getItem('oauth_state')) {
                    addLog('G√ºvenlik hatasƒ±: State e≈üle≈ümiyor', 'error');
                    return;
                }
                
                localStorage.setItem('youtube_access_token', token);
                localStorage.removeItem('oauth_state');
                addLog('YouTube yetkilendirmesi ba≈üarƒ±lƒ±', 'success');
                showNotification('‚úÖ YouTube\'a baƒülandƒ±nƒ±z!');
                
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        // ==================== ANALYSIS FUNCTIONS ====================
        async function analyzeTopic() {
            const query = document.getElementById('analyzeQuery').value.trim();
            if (!query) {
                alert('Analiz edilecek konu girin');
                return;
            }

            const progress = document.getElementById('analyzeProgress');
            const fill = document.getElementById('analyzeProgressFill');
            const btn = document.getElementById('analyzeBtn');
            
            progress.classList.add('active');
            btn.disabled = true;
            fill.style.width = '20%';
            
            try {
                addLog(`"${query}" i√ßin trend analizi ba≈ülatƒ±lƒ±yor...`, 'info');
                
                const prompt = `Sen bir YouTube i√ßerik stratejisti ve viral video uzmanƒ±sƒ±n. 
                
"${query}" konusu i√ßin kapsamlƒ± bir trend analizi yap. A≈üaƒüƒ±daki formatta JSON d√∂nd√ºr:

{
  "niche_analysis": "Bu ni≈üin durumu, rekabet seviyesi, b√ºy√ºme potansiyeli (2-3 c√ºmle)",
  "target_audience": "Hedef kitle tanƒ±mƒ±",
  "content_themes": ["trend konu 1", "trend konu 2", "trend konu 3", "trend konu 4", "trend konu 5"],
  "viral_strategies": [
    "Strateji 1: ...",
    "Strateji 2: ...",
    "Strateji 3: ..."
  ],
  "content_calendar": [
    {"day": "Pazartesi", "topic": "...", "format": "Shorts/Video", "viral_potential": 8},
    {"day": "√áar≈üamba", "topic": "...", "format": "Shorts/Video", "viral_potential": 9},
    {"day": "Cuma", "topic": "...", "format": "Shorts/Video", "viral_potential": 7}
  ],
  "optimal_posting_times": "En iyi yayƒ±n saatleri",
  "hashtag_strategy": ["#etiket1", "#etiket2", "#etiket3", "#etiket4", "#etiket5"],
  "estimated_growth": "30 g√ºnde ula≈üƒ±labilecek tahmini b√ºy√ºme"
}

Sadece JSON d√∂nd√ºr, ba≈üka a√ßƒ±klama ekleme.`;
                
                fill.style.width = '60%';
                const response = await callGemini(prompt, 0.8);
                fill.style.width = '100%';
                
                // Parse JSON from response
                let analysis;
                try {
                    // Extract JSON if wrapped in markdown
                    const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/) || 
                                     response.match(/```\s*([\s\S]*?)\s*```/) ||
                                     [null, response];
                    analysis = JSON.parse(jsonMatch[1] || response);
                } catch (e) {
                    // If JSON parse fails, display as text
                    analysis = { raw_response: response };
                }
                
                channelAnalysis = analysis;
                
                // Display formatted analysis
                const contentDiv = document.getElementById('analysisContent');
                contentDiv.innerHTML = formatAnalysis(analysis);
                
                document.getElementById('aiAnalysisResult').classList.remove('hidden');
                showStatus('analyzeStatus', '‚úÖ Analiz tamamlandƒ±!', 'success');
                addLog('Trend analizi tamamlandƒ±', 'success');
                
            } catch (e) {
                showStatus('analyzeStatus', '‚ùå Hata: ' + e.message, 'error');
                addLog('Analiz hatasƒ±: ' + e.message, 'error');
            } finally {
                btn.disabled = false;
                setTimeout(() => progress.classList.remove('active'), 1000);
            }
        }

        function formatAnalysis(data) {
            if (data.raw_response) {
                return `<pre style="white-space: pre-wrap;">${data.raw_response}</pre>`;
            }
            
            let html = `
                <div style="margin-bottom: 15px;">
                    <strong style="color: #4285f4;">üéØ Ni≈ü Analizi:</strong>
                    <p>${data.niche_analysis || 'Veri yok'}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <strong style="color: #4285f4;">üë• Hedef Kitle:</strong>
                    <p>${data.target_audience || 'Veri yok'}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <strong style="color: #4285f4;">üî• Trend Konular:</strong>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        ${(data.content_themes || []).map(t => `<li>${t}</li>`).join('')}
                    </ul>
                </div>
                <div style="margin-bottom: 15px;">
                    <strong style="color: #4285f4;">üìà Viral Stratejiler:</strong>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        ${(data.viral_strategies || []).map(s => `<li>${s}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            if (data.content_calendar) {
                html += `
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #4285f4;">üìÖ ƒ∞√ßerik Takvimi:</strong>
                        <div style="margin-top: 10px;">
                            ${data.content_calendar.map(item => `
                                <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 5px; margin-bottom: 5px;">
                                    <strong>${item.day}</strong> - ${item.topic} 
                                    <span class="viral-score ${item.viral_potential >= 8 ? 'high' : item.viral_potential >= 5 ? 'medium' : 'low'}">
                                        ${item.viral_potential}/10
                                    </span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            return html;
        }

        // ==================== MEDIA FUNCTIONS ====================
        async function searchMedia() {
            const query = document.getElementById('mediaSearch').value.trim();
            const source = document.getElementById('mediaSource').value;
            
            if (!query) {
                alert('Arama kelimesi girin');
                return;
            }
            
            try {
                addLog(`${source} i√ßin "${query}" aranƒ±yor...`, 'info');
                const response = await fetch(`/.netlify/functions/media-proxy?source=${source}&query=${encodeURIComponent(query)}&per_page=12`);
                
                if (!response.ok) throw new Error('Medya arama hatasƒ±');
                
                const data = await response.json();
                
                const container = document.getElementById('mediaResults');
                container.classList.remove('hidden');
                
                if (data.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #666;">Sonu√ß bulunamadƒ±.</p>';
                    return;
                }
                
                container.innerHTML = data.map(m => `
                    <div class="media-item" onclick="toggleMedia('${m.fullUrl}', this)" data-url="${m.fullUrl}">
                        <img src="${m.url}" loading="lazy" alt="${m.credit}">
                        <div class="credit">${m.credit}</div>
                    </div>
                `).join('');
                
                addLog(`${data.length} g√∂rsel bulundu`, 'success');
            } catch (e) {
                addLog('G√∂rsel arama hatasƒ±: ' + e.message, 'error');
                alert('G√∂rsel arama hatasƒ±: ' + e.message);
            }
        }

        function toggleMedia(url, el) {
            if (el.classList.contains('selected')) {
                el.classList.remove('selected');
                selectedMedia = selectedMedia.filter(u => u !== url);
            } else {
                // Limit to 5 images
                if (selectedMedia.length >= 5) {
                    alert('En fazla 5 g√∂rsel se√ßebilirsiniz');
                    return;
                }
                el.classList.add('selected');
                selectedMedia.push(url);
            }
        }

        // ==================== VIDEO CREATION ====================
        async function createVideo() {
            const prompt = document.getElementById('videoPrompt').value.trim();
            const duration = document.getElementById('videoDuration').value;
            const format = document.getElementById('videoFormat').value;
            
            if (!prompt) {
                alert('Video konusu girin');
                return;
            }

            const btn = document.getElementById('createBtn');
            const progress = document.getElementById('createProgress');
            const fill = document.getElementById('createProgressFill');
            
            btn.disabled = true;
            progress.classList.add('active');

            try {
                fill.style.width = '10%';
                addLog('Video i√ßeriƒüi Gemini ile olu≈üturuluyor...', 'info');
                
                const aiPrompt = `Sen bir YouTube i√ßerik √ºreticisisin. "${prompt}" konusunda bir YouTube ${format === 'shorts' ? 'Shorts' : 'video'} i√ßeriƒüi olu≈ütur.

Kriterler:
- S√ºre: Yakla≈üƒ±k ${duration} saniye
- Format: ${format === 'shorts' ? 'Dikey 9:16 (Shorts i√ßin)' : 'Yatay 16:9'}
- Dil: T√ºrk√ße
- Tarz: ƒ∞lgi √ßekici, viral olabilecek, SEO uyumlu

A≈üaƒüƒ±daki formatta JSON d√∂nd√ºr:

{
  "title": "Video ba≈ülƒ±ƒüƒ± (maksimum 60 karakter, ilgi √ßekici, emoji kullan)",
  "description": "Video a√ßƒ±klamasƒ± (SEO i√ßin anahtar kelimeler i√ßersin, maksimum 200 karakter)",
  "tags": "tag1, tag2, tag3, tag4, tag5 (viral olabilecek etiketler, virg√ºlle ayrƒ±lmƒ±≈ü)",
  "script": "Video senaryosu / metni. S√ºreyi dolduracak kadar detaylƒ± olsun. Konu≈üma dilinde, samimi ve ilgi √ßekici yaz.",
  "hook": "ƒ∞lk 3 saniyede kullanƒ±lacak kancalƒ± c√ºmle (dikkat √ßekici)",
  "call_to_action": "Sonunda kullanƒ±lacak √ßaƒürƒ± (abone ol, yorum yap, vb.)",
  "viral_score": 8,
  "why_viral": "Bu i√ßeriƒüin neden viral olabileceƒüinin kƒ±sa a√ßƒ±klamasƒ±"
}

Sadece JSON d√∂nd√ºr, ba≈üka a√ßƒ±klama ekleme.`;
                
                fill.style.width = '40%';
                const aiResponse = await callGemini(aiPrompt, 0.8);
                fill.style.width = '70%';
                
                // Parse JSON
                let content;
                try {
                    const jsonMatch = aiResponse.match(/```json\s*([\s\S]*?)\s*```/) || 
                                     aiResponse.match(/```\s*([\s\S]*?)\s*```/) ||
                                     [null, aiResponse];
                    content = JSON.parse(jsonMatch[1] || aiResponse);
                } catch (e) {
                    // Fallback parsing
                    content = {
                        title: prompt.substring(0, 60),
                        description: prompt,
                        tags: 'shorts,viral,trending,2024',
                        script: aiResponse,
                        hook: prompt,
                        call_to_action: 'Kanala abone olmayƒ± unutmayƒ±n!',
                        viral_score: 7,
                        why_viral: 'AI tarafƒ±ndan olu≈üturuldu'
                    };
                }
                
                fill.style.width = '100%';
                
                currentVideo = {
                    id: Date.now(),
                    ...content,
                    format: format,
                    duration: duration,
                    status: 'preview',
                    createdAt: new Date().toISOString(),
                    selectedMedia: selectedMedia
                };

                showPreview();
                showStatus('createStatus', `‚úÖ "${content.title}" hazƒ±r! Viral skor: ${content.viral_score}/10`, 'success');
                addLog(`Video olu≈üturuldu: ${content.title} (Skor: ${content.viral_score})`, 'success');

            } catch (e) {
                showStatus('createStatus', '‚ùå Hata: ' + e.message, 'error');
                addLog('Video olu≈üturma hatasƒ±: ' + e.message, 'error');
                alert('Hata: ' + e.message);
            } finally {
                btn.disabled = false;
                setTimeout(() => progress.classList.remove('active'), 1000);
            }
        }

        function showPreview() {
            const modal = document.getElementById('previewModal');
            const details = document.getElementById('previewDetails');
            const scriptBox = document.getElementById('previewScript');
            
            scriptBox.textContent = currentVideo.script || 'Senaryo yok';
            
            details.innerHTML = `
                <h4 style="color: #fff; margin-bottom: 10px; font-size: 1.2em;">${currentVideo.title}</h4>
                <p style="margin-bottom: 10px;">
                    <span class="viral-score ${currentVideo.viral_score >= 8 ? 'high' : currentVideo.viral_score >= 5 ? 'medium' : 'low'}">
                        üéØ Viral Skor: ${currentVideo.viral_score}/10
                    </span>
                </p>
                <p style="color: #aaa; margin-bottom: 10px;"><strong>A√ßƒ±klama:</strong> ${currentVideo.description}</p>
                <p style="color: #aaa; margin-bottom: 10px;"><strong>Etiketler:</strong> ${currentVideo.tags}</p>
                <p style="color: #aaa; margin-bottom: 10px;"><strong>Kanca (Hook):</strong> ${currentVideo.hook}</p>
                <p style="color: #aaa; margin-bottom: 10px;"><strong>√áaƒürƒ±:</strong> ${currentVideo.call_to_action}</p>
                ${currentVideo.why_viral ? `<p style="color: #4285f4; font-size: 0.9em;"><strong>Neden Viral?</strong> ${currentVideo.why_viral}</p>` : ''}
                ${currentVideo.selectedMedia && currentVideo.selectedMedia.length > 0 ? 
                    `<p style="color: #00b894; margin-top: 10px;">‚úÖ ${currentVideo.selectedMedia.length} g√∂rsel se√ßildi</p>` : ''}
            `;
            
            modal.style.display = 'flex';
        }

        function closePreview() {
            document.getElementById('previewModal').style.display = 'none';
        }

        function downloadContent() {
            const content = `YOUTUBE VIDEO ƒ∞√áERƒ∞ƒûƒ∞
===================

BA≈ûLIK:
${currentVideo.title}

A√áIKLAMA:
${currentVideo.description}

ETƒ∞KETLER:
${currentVideo.tags}

KANCA (HOOK):
${currentVideo.hook}

SENARYO:
${currentVideo.script}

√áAƒûRI (CTA):
${currentVideo.call_to_action}

VIRAL SKOR: ${currentVideo.viral_score}/10
${currentVideo.why_viral ? 'NEDEN VIRAL: ' + currentVideo.why_viral : ''}

FORMAT: ${currentVideo.format}
S√úRE: ${currentVideo.duration} saniye
OLU≈ûTURMA TARƒ∞Hƒ∞: ${new Date(currentVideo.createdAt).toLocaleString('tr-TR')}

===================
Melez YouTube AI Sistemi - Gemini Edition
`;
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentVideo.title.replace(/[^a-z0-9ƒü√º≈üƒ±√∂√ßƒ∞ƒû√ú≈û√ñ√á]/gi, '_').substring(0, 50)}_icerik.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            addLog('ƒ∞√ßerik indirildi', 'success');
            showNotification('‚úÖ ƒ∞√ßerik indirildi!');
        }

        // ==================== YOUTUBE UPLOAD ====================
        async function uploadToYouTube() {
            const token = localStorage.getItem('youtube_access_token');
            if (!token) {
                alert('√ñnce YouTube\'a baƒülanƒ±n (Ayarlar sekmesi)');
                return;
            }

            const progress = document.getElementById('uploadProgress');
            const fill = document.getElementById('uploadProgressFill');
            progress.classList.add('active');

            try {
                fill.style.width = '30%';
                addLog('YouTube\'a y√ºkleniyor...', 'info');
                
                const metadata = {
                    snippet: {
                        title: currentVideo.title,
                        description: currentVideo.description + '\n\n' + currentVideo.script + '\n\n#shorts #viral #trending\nCreated with Melez AI Video Maker',
                        tags: currentVideo.tags.split(',').map(t => t.trim()),
                        categoryId: '24' // Entertainment
                    },
                    status: { 
                        privacyStatus: 'public',
                        selfDeclaredMadeForKids: false
                    }
                };

                // Note: Actual video file upload requires multipart/form-data with video binary
                // This is a metadata-only upload for demonstration
                // For full video upload, you'd need to implement resumable upload protocol
                
                const response = await fetch('https://www.googleapis.com/upload/youtube/v3/videos?part=snippet,status', {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(metadata)
                });

                const result = await response.json();
                
                if (!response.ok) {
                    throw new Error(result.error?.message || 'YouTube API hatasƒ±');
                }

                fill.style.width = '100%';
                currentVideo.youtubeId = result.id;
                currentVideo.status = 'uploaded';
                currentVideo.youtubeUrl = `https://youtube.com/watch?v=${result.id}`;
                
                videos.push({...currentVideo});
                localStorage.setItem('ytVideosGemini', JSON.stringify(videos));
                
                updateVideoList();
                updateStats();
                
                showStatus('uploadStatus', `‚úÖ Video metadata y√ºklendi! Video ID: ${result.id}`, 'success');
                addLog('YouTube\'a y√ºklendi: ' + result.id, 'success');
                
                // Note: This uploads metadata only. For actual video file, you need:
                // 1. Resumable upload session olu≈üturma
                // 2. Video binary'sini chunk'lar halinde g√∂nderme
                // 3. Netlify Functions'da 10MB+ dosya i≈üleme limitleri var
                
            } catch (e) {
                showStatus('uploadStatus', '‚ùå Hata: ' + e.message, 'error');
                addLog('Y√ºkleme hatasƒ±: ' + e.message, 'error');
                
                if (e.message.includes('401')) {
                    alert('Oturum s√ºresi dolmu≈ü. Tekrar baƒülanƒ±n.');
                    localStorage.removeItem('youtube_access_token');
                }
            } finally {
                setTimeout(() => progress.classList.remove('active'), 2000);
            }
        }

        function rejectVideo() {
            if (confirm('Videoyu silmek istediƒüinize emin misiniz?')) {
                currentVideo = null;
                closePreview();
                addLog('Video silindi', 'warning');
            }
        }

        // ==================== VIDEO LIST MANAGEMENT ====================
        function updateVideoList() {
            const container = document.getElementById('videoList');
            if (videos.length === 0) {
                container.innerHTML = '<p style="text-align:center;color:#666;padding:40px">Hen√ºz video yok.</p>';
                return;
            }
            
            container.innerHTML = videos.slice().reverse().map(v => `
                <div class="video-item ${v.status}">
                    <div class="video-info">
                        <h4>${v.title}</h4>
                        <p>${v.status === 'uploaded' ? '‚úÖ ' + new Date(v.createdAt).toLocaleDateString('tr-TR') : '‚è≥ Bekliyor'} | 
                           Skor: ${v.viral_score}/10 | 
                           ${v.format === 'shorts' ? 'üì± Shorts' : 'üì∫ Video'}</p>
                    </div>
                    <div class="video-actions">
                        ${v.youtubeUrl ? `<a href="${v.youtubeUrl}" target="_blank" class="btn-primary" style="text-decoration:none;padding:8px 15px;font-size:12px">‚ñ∂Ô∏è ƒ∞zle</a>` : ''}
                        <button class="btn-secondary" onclick="loadVideo(${v.id})" style="padding:8px 15px;font-size:12px">üìÇ</button>
                        <button class="btn-danger" onclick="deleteVideo(${v.id})" style="padding:8px 15px;font-size:12px">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function loadVideo(id) {
            const video = videos.find(v => v.id === id);
            if (video) {
                currentVideo = video;
                showPreview();
            }
        }

        function updateStats() {
            document.getElementById('totalVideos').textContent = videos.length;
            document.getElementById('uploadedVideos').textContent = videos.filter(v => v.status === 'uploaded').length;
            document.getElementById('viralVideos').textContent = videos.filter(v => v.viral_score >= 8).length;
            document.getElementById('savedCredits').textContent = videos.length * 15; // Estimated savings
        }

        function deleteVideo(id) {
            if (!confirm('Silmek istediƒüinize emin misiniz?')) return;
            videos = videos.filter(v => v.id !== id);
            localStorage.setItem('ytVideosGemini', JSON.stringify(videos));
            updateVideoList();
            updateStats();
            addLog('Video silindi', 'warning');
        }

        // ==================== LOGGING ====================
        function addLog(msg, type = 'info') {
            const container = document.getElementById('logContainer');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            const time = new Date().toLocaleTimeString('tr-TR');
            entry.textContent = `[${time}] ${msg}`;
            container.appendChild(entry);
            container.scrollTop = container.scrollHeight;
            
            // Limit log entries
            while (container.children.length > 100) {
                container.removeChild(container.firstChild);
            }
        }

        function clearLogs() {
            document.getElementById('logContainer').innerHTML = '';
            addLog('Loglar temizlendi', 'info');
        }

        function showStatus(id, msg, type) {
            const el = document.getElementById(id);
            el.innerHTML = msg;
            el.className = 'status ' + type;
        }
    </script>
</body>
</html>